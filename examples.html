
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Examples &#8212; dmslogo 0.2.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="dmslogo package" href="dmslogo.html" />
    <link rel="prev" title="Installation" href="installation.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="examples">
<span id="id1"></span><h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#import-packages-modules" id="id2">Import packages / modules</a></li>
<li><a class="reference internal" href="#simple-example-on-toy-data" id="id3">Simple example on toy data</a><ul>
<li><a class="reference internal" href="#draw-a-basic-logo" id="id4">Draw a basic logo</a></li>
<li><a class="reference internal" href="#drawing-without-breaks" id="id5">Drawing without breaks</a></li>
<li><a class="reference internal" href="#setting-letter-colors" id="id6">Setting letter colors</a></li>
<li><a class="reference internal" href="#labeling-x-axis-ticks" id="id7">Labeling x-axis ticks</a></li>
<li><a class="reference internal" href="#adjusting-size-axis-labels-axes" id="id8">Adjusting size, axis labels, axes</a></li>
<li><a class="reference internal" href="#multiple-logos-in-one-figure" id="id9">Multiple logos in one figure</a></li>
</ul>
</li>
<li><a class="reference internal" href="#real-hiv-data-from-dingens-et-al" id="id10">Real HIV data from Dingens et al</a><ul>
<li><a class="reference internal" href="#download-data-to-plot" id="id11">Download data to plot</a></li>
<li><a class="reference internal" href="#draw-a-logo-plot" id="id12">Draw a logo plot</a></li>
<li><a class="reference internal" href="#draw-site-level-line-plots" id="id13">Draw site-level line plots</a></li>
<li><a class="reference internal" href="#combining-site-level-line-and-mutation-level-logo-plots" id="id14">Combining site-level line and mutation-level logo plots</a></li>
</ul>
</li>
<li><a class="reference internal" href="#faceting-line-and-logo-plots-together" id="id15">Faceting line and logo plots together</a></li>
<li><a class="reference internal" href="#write-dmslogo-in-comic-sans-font" id="id16">Write <em>DMSLOGO</em> in Comic Sans font</a><ul>
<li><a class="reference internal" href="#subtleties-of-non-default-fonts" id="id17">Subtleties of non-default fonts</a></li>
</ul>
</li>
</ul>
</div>
<a class="reference download internal" href="examples_full.ipynb">Download this page as a Jupyter notebook (with outputs)</a><div class="section" id="import-packages-modules">
<h2><a class="toc-backref" href="#id2">Import packages / modules</a><a class="headerlink" href="#import-packages-modules" title="Permalink to this headline">¶</a></h2>
<p>Import <cite>dmslogo</cite> along with the other Python packages used in
these examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">string</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tempfile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dmslogo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dmslogo.colorschemes</span> <span class="k">import</span> <span class="n">CBPALETTE</span>
</pre></div>
</div>
<p>Set options to display pandas DataFrames:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.width&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="simple-example-on-toy-data">
<h2><a class="toc-backref" href="#id3">Simple example on toy data</a><a class="headerlink" href="#simple-example-on-toy-data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="draw-a-basic-logo">
<h3><a class="toc-backref" href="#id4">Draw a basic logo</a><a class="headerlink" href="#draw-a-basic-logo" title="Permalink to this headline">¶</a></h3>
<p>Simple plotting can be done using the <a class="reference internal" href="dmslogo.logo.html#dmslogo.logo.draw_logo" title="dmslogo.logo.draw_logo"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dmslogo.logo.draw_logo</span></code></a>
function.</p>
<p>This function takes in as input a pandas DataFrame that has columns
with:</p>
<blockquote>
<div><ul class="simple">
<li>site in sequential integer numbering</li>
<li>letter (i.e., amino acid or nucleotide)</li>
<li>height of letter (can be any positive number)</li>
</ul>
</div></blockquote>
<p>Here make a simple data frame that fits these specs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">data</span><span class="o">=</span>   <span class="p">[(</span>    <span class="mi">1</span><span class="p">,</span>      <span class="s1">&#39;A&#39;</span><span class="p">,</span>        <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>                 <span class="p">(</span>    <span class="mi">1</span><span class="p">,</span>      <span class="s1">&#39;C&#39;</span><span class="p">,</span>      <span class="mf">0.7</span><span class="p">),</span>
<span class="gp">... </span>                 <span class="p">(</span>    <span class="mi">2</span><span class="p">,</span>      <span class="s1">&#39;C&#39;</span><span class="p">,</span>      <span class="mf">0.1</span><span class="p">),</span>
<span class="gp">... </span>                 <span class="p">(</span>    <span class="mi">2</span><span class="p">,</span>      <span class="s1">&#39;D&#39;</span><span class="p">,</span>      <span class="mf">1.2</span><span class="p">),</span>
<span class="gp">... </span>                 <span class="p">(</span>    <span class="mi">5</span><span class="p">,</span>      <span class="s1">&#39;A&#39;</span><span class="p">,</span>      <span class="mf">0.4</span><span class="p">),</span>
<span class="gp">... </span>                 <span class="p">(</span>    <span class="mi">5</span><span class="p">,</span>      <span class="s1">&#39;K&#39;</span><span class="p">,</span>      <span class="mf">0.4</span><span class="p">)],</span>
<span class="gp">... </span>        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;site&#39;</span><span class="p">,</span> <span class="s1">&#39;letter&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">])</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>
<span class="go">   site letter  height</span>
<span class="go">0     1      A     1.0</span>
<span class="go">1     1      C     0.7</span>
<span class="go">2     2      C     0.1</span>
<span class="go">3     2      D     1.2</span>
<span class="go">4     5      A     0.4</span>
<span class="go">5     5      K     0.4</span>
</pre></div>
</div>
<p>Use <a class="reference internal" href="dmslogo.logo.html#dmslogo.logo.draw_logo" title="dmslogo.logo.draw_logo"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dmslogo.logo.draw_logo</span></code></a> to draw the logo plot, passing
the names of the columns with each piece of required data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">dmslogo</span><span class="o">.</span><span class="n">draw_logo</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">x_col</span><span class="o">=</span><span class="s1">&#39;site&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">letter_col</span><span class="o">=</span><span class="s1">&#39;letter&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">letter_height_col</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//examples-4.png">png</a>, <a class="reference external" href=".//examples-4.hires.png">hires.png</a>, <a class="reference external" href=".//examples-4.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/examples-4.png" src="_images/examples-4.png" />
</div>
<p>Add a title:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">dmslogo</span><span class="o">.</span><span class="n">draw_logo</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">x_col</span><span class="o">=</span><span class="s1">&#39;site&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">letter_col</span><span class="o">=</span><span class="s1">&#39;letter&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">letter_height_col</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;basic example&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//examples-5.png">png</a>, <a class="reference external" href=".//examples-5.hires.png">hires.png</a>, <a class="reference external" href=".//examples-5.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/examples-5.png" src="_images/examples-5.png" />
</div>
<p>Note that the call to <a class="reference internal" href="dmslogo.logo.html#dmslogo.logo.draw_logo" title="dmslogo.logo.draw_logo"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dmslogo.logo.draw_logo</span></code></a> returns
matplotlib Figure and Axis instances, which we have called <code class="docutils literal notranslate"><span class="pre">fig</span></code> and
<code class="docutils literal notranslate"><span class="pre">ax</span></code>. We can save the figure to a file using the
<a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.savefig.html">savefig</a>
command of <code class="docutils literal notranslate"><span class="pre">fig</span></code>. Below we show an example of how to do this saving to
a temporary file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;wb&#39;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">450</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="drawing-without-breaks">
<h3><a class="toc-backref" href="#id5">Drawing without breaks</a><a class="headerlink" href="#drawing-without-breaks" title="Permalink to this headline">¶</a></h3>
<p>Note how the above plot has a “break” (gap and dashed line) to indicate
a break in the sequential numbering in <code class="docutils literal notranslate"><span class="pre">x_col</span></code> between 2 and 5. This
is useful as it indicates when we are breaking the sequence when drawing
just snippets of a protein. If you do <strong>not</strong> want to indicate breaks in
this way, turn off the <code class="docutils literal notranslate"><span class="pre">addbreaks</span></code> option. Now the logo just goes
directly from 2 to 5 without indicating a break:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">dmslogo</span><span class="o">.</span><span class="n">draw_logo</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">x_col</span><span class="o">=</span><span class="s1">&#39;site&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">letter_col</span><span class="o">=</span><span class="s1">&#39;letter&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">letter_height_col</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">addbreaks</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//examples-7.png">png</a>, <a class="reference external" href=".//examples-7.hires.png">hires.png</a>, <a class="reference external" href=".//examples-7.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/examples-7.png" src="_images/examples-7.png" />
</div>
</div>
<div class="section" id="setting-letter-colors">
<h3><a class="toc-backref" href="#id6">Setting letter colors</a><a class="headerlink" href="#setting-letter-colors" title="Permalink to this headline">¶</a></h3>
<p>The above plot colored letters using a default amino-acid coloring
scheme. You can set a different coloring scheme using <code class="docutils literal notranslate"><span class="pre">colorscheme</span></code>
and <code class="docutils literal notranslate"><span class="pre">missing_color</span></code>, or you can set letter colors at a site-specific
level by adding a column to <code class="docutils literal notranslate"><span class="pre">data</span></code> that specifies the colors. Here we
color letters at site-specific level:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>
<span class="go">   site letter  height color</span>
<span class="go">0     1      A     1.0   red</span>
<span class="go">1     1      C     0.7  gray</span>
<span class="go">2     2      C     0.1  gray</span>
<span class="go">3     2      D     1.2  gray</span>
<span class="go">4     5      A     0.4   red</span>
<span class="go">5     5      K     0.4  gray</span>
</pre></div>
</div>
<p>Now plot using <code class="docutils literal notranslate"><span class="pre">color_col</span></code> to set the colors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">dmslogo</span><span class="o">.</span><span class="n">draw_logo</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">x_col</span><span class="o">=</span><span class="s1">&#39;site&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">letter_col</span><span class="o">=</span><span class="s1">&#39;letter&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">letter_height_col</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">color_col</span><span class="o">=</span><span class="s1">&#39;color&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//examples-9.png">png</a>, <a class="reference external" href=".//examples-9.hires.png">hires.png</a>, <a class="reference external" href=".//examples-9.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/examples-9.png" src="_images/examples-9.png" />
</div>
</div>
<div class="section" id="labeling-x-axis-ticks">
<h3><a class="toc-backref" href="#id7">Labeling x-axis ticks</a><a class="headerlink" href="#labeling-x-axis-ticks" title="Permalink to this headline">¶</a></h3>
<p>Sometimes we want to label sites with something other than the
sequential integer numbers. We can do this by adding a column for the
xtick labels to <code class="docutils literal notranslate"><span class="pre">data</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;site_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;F5&#39;</span><span class="p">,</span> <span class="s1">&#39;F5&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>
<span class="go">   site letter  height color site_label</span>
<span class="go">0     1      A     1.0   red         D1</span>
<span class="go">1     1      C     0.7  gray         D1</span>
<span class="go">2     2      C     0.1  gray         A2</span>
<span class="go">3     2      D     1.2  gray         A2</span>
<span class="go">4     5      A     0.4   red         F5</span>
<span class="go">5     5      K     0.4  gray         F5</span>
</pre></div>
</div>
<p>Now use <code class="docutils literal notranslate"><span class="pre">xtick_col</span></code> to set the xticks:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">dmslogo</span><span class="o">.</span><span class="n">draw_logo</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">x_col</span><span class="o">=</span><span class="s1">&#39;site&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">letter_col</span><span class="o">=</span><span class="s1">&#39;letter&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">letter_height_col</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">color_col</span><span class="o">=</span><span class="s1">&#39;color&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">xtick_col</span><span class="o">=</span><span class="s1">&#39;site_label&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//examples-11.png">png</a>, <a class="reference external" href=".//examples-11.hires.png">hires.png</a>, <a class="reference external" href=".//examples-11.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/examples-11.png" src="_images/examples-11.png" />
</div>
</div>
<div class="section" id="adjusting-size-axis-labels-axes">
<h3><a class="toc-backref" href="#id8">Adjusting size, axis labels, axes</a><a class="headerlink" href="#adjusting-size-axis-labels-axes" title="Permalink to this headline">¶</a></h3>
<p>We can do additional formatting by scaling the width (<code class="docutils literal notranslate"><span class="pre">widthscale</span></code>),
the height (<code class="docutils literal notranslate"><span class="pre">heightscale</span></code>), the axis font (<code class="docutils literal notranslate"><span class="pre">axisfontscale</span></code>), the
x-axis (<code class="docutils literal notranslate"><span class="pre">xlabel</span></code>) and y-axis (<code class="docutils literal notranslate"><span class="pre">ylabel</span></code>) labels, and removing the
axes altogether (<code class="docutils literal notranslate"><span class="pre">hide_axis</span></code>).</p>
<p>First, we make a plot where we adjust the size, change the y-axis label,
and get rid of the x-axis label:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">dmslogo</span><span class="o">.</span><span class="n">draw_logo</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">x_col</span><span class="o">=</span><span class="s1">&#39;site&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">letter_col</span><span class="o">=</span><span class="s1">&#39;letter&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">letter_height_col</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">color_col</span><span class="o">=</span><span class="s1">&#39;color&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">xtick_col</span><span class="o">=</span><span class="s1">&#39;site_label&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;immune selection&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">heightscale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">axisfontscale</span><span class="o">=</span><span class="mf">1.5</span>
<span class="gp">... </span>                            <span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//examples-12.png">png</a>, <a class="reference external" href=".//examples-12.hires.png">hires.png</a>, <a class="reference external" href=".//examples-12.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/examples-12.png" src="_images/examples-12.png" />
</div>
<p>Now we make a plot where we hide the axes and their labels altogether:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">dmslogo</span><span class="o">.</span><span class="n">draw_logo</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">x_col</span><span class="o">=</span><span class="s1">&#39;site&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">letter_col</span><span class="o">=</span><span class="s1">&#39;letter&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">letter_height_col</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">color_col</span><span class="o">=</span><span class="s1">&#39;color&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">xtick_col</span><span class="o">=</span><span class="s1">&#39;site_label&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">hide_axis</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span>                            <span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//examples-13.png">png</a>, <a class="reference external" href=".//examples-13.hires.png">hires.png</a>, <a class="reference external" href=".//examples-13.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/examples-13.png" src="_images/examples-13.png" />
</div>
</div>
<div class="section" id="multiple-logos-in-one-figure">
<h3><a class="toc-backref" href="#id9">Multiple logos in one figure</a><a class="headerlink" href="#multiple-logos-in-one-figure" title="Permalink to this headline">¶</a></h3>
<p>So far we have made individual plots on newly generate figures created
by <a class="reference internal" href="dmslogo.logo.html#dmslogo.logo.draw_logo" title="dmslogo.logo.draw_logo"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dmslogo.logo.draw_logo</span></code></a>.</p>
<p>But we can also create a multi-axis figure, and then draw several logos
onto that. The easiest way to do this is with the
<a class="reference internal" href="dmslogo.facet.html#dmslogo.facet.facet_plot" title="dmslogo.facet.facet_plot"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dmslogo.facet.facet_plot</span></code></a> command described below. But we can
also do it using matplotlib subplots as here:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># make figure with two subplots: two rows, one column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span> <span class="c1"># add more vertical space for axis titles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># draw top plot, no x-axis ticks or label, default coloring</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">dmslogo</span><span class="o">.</span><span class="n">draw_logo</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">no_ticks</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
<span class="gp">... </span>                      <span class="n">x_col</span><span class="o">=</span><span class="s1">&#39;site&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">letter_col</span><span class="o">=</span><span class="s1">&#39;letter&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">letter_height_col</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">xtick_col</span><span class="o">=</span><span class="s1">&#39;no_ticks&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">title</span><span class="o">=</span><span class="s1">&#39;colored by amino acid&#39;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># draw bottom plot, color as specified in `data`</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">dmslogo</span><span class="o">.</span><span class="n">draw_logo</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">x_col</span><span class="o">=</span><span class="s1">&#39;site&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">letter_col</span><span class="o">=</span><span class="s1">&#39;letter&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">letter_height_col</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">color_col</span><span class="o">=</span><span class="s1">&#39;color&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">title</span><span class="o">=</span><span class="s1">&#39;user-specified colors&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//examples-14.png">png</a>, <a class="reference external" href=".//examples-14.hires.png">hires.png</a>, <a class="reference external" href=".//examples-14.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/examples-14.png" src="_images/examples-14.png" />
</div>
</div>
</div>
<div class="section" id="real-hiv-data-from-dingens-et-al">
<h2><a class="toc-backref" href="#id10">Real HIV data from Dingens et al</a><a class="headerlink" href="#real-hiv-data-from-dingens-et-al" title="Permalink to this headline">¶</a></h2>
<p>In <a class="reference external" href="https://doi.org/10.1016/j.immuni.2018.12.017">An Antigenic Atlas of HIV-1 Escape from Broadly Neutralizing
Antibodies Distinguishes Functional and Structural
Epitopes</a> (Dingens et
al, 2019), there are plots of immune selection on HIV envelope (Env)
from anti-HIV antibodies at just a subset of “strongly selected” sites
for each antibody.</p>
<p>Here we use <code class="docutils literal notranslate"><span class="pre">dmslogo</span></code> to re-create one of those plots (the one in
Figure 3D,E) showing antibodies <em>PG9</em> and <em>PGT145</em>.</p>
<div class="section" id="download-data-to-plot">
<h3><a class="toc-backref" href="#id11">Download data to plot</a><a class="headerlink" href="#download-data-to-plot" title="Permalink to this headline">¶</a></h3>
<p>Download the data from the paper’s <a class="reference external" href="https://github.com/jbloomlab/EnvsAntigenicAtlas/">GitHub
repo</a> giving the
immune selection (as <a class="reference external" href="https://jbloomlab.github.io/dms_tools2/fracsurvive.html">fraction surviving above
average</a>)
for these two antibodies, and read the data into a DataFrame:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">antibodies</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PG9&#39;</span><span class="p">,</span> <span class="s1">&#39;PGT145&#39;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_hiv</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">antibody</span> <span class="ow">in</span> <span class="n">antibodies</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">datafile</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/jbloomlab/EnvsAntigenicAtlas/master/results/&#39;</span>
<span class="gp">... </span>                <span class="n">f</span><span class="s2">&quot;fracsurviveaboveavg/concavg_wtDNA_ctrl/summary_</span><span class="si">{antibody}</span><span class="s2">-medianmutfracsurvive.csv&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">datafile</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">data_hiv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">antibody</span><span class="o">=</span><span class="n">antibody</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_hiv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">data_hiv</span><span class="p">)</span>
</pre></div>
</div>
<p>Here are the first few lines of the data frame. For each mutation it
gives the immune selection (<em>mutfracsurvive</em>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data_hiv</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">  site wildtype mutation  mutfracsurvive antibody</span>
<span class="go">0  160        N        I        0.256342      PG9</span>
<span class="go">1  160        N        L        0.207440      PG9</span>
<span class="go">2  160        N        R        0.184067      PG9</span>
<span class="go">3  171        K        E        0.176118      PG9</span>
<span class="go">4  428        Q        Y        0.150981      PG9</span>
</pre></div>
</div>
<p>The sites in this data frame are in the <a class="reference external" href="https://www.hiv.lanl.gov/content/sequence/HIV/REVIEWS/HXB2.html">HXB2 numbering
scheme</a>,
which is <strong>not</strong> the same as sequential integer numbering of the actual
BG505 Env for which the immune selection was measured. So for our
plotting, we also need to create a column (which we will call <code class="docutils literal notranslate"><span class="pre">isite</span></code>)
that numbers the sites a sequential numbering. A file that converts
between HXB2 and and BG505 numbering is part of the paper’s <a class="reference external" href="https://github.com/jbloomlab/EnvsAntigenicAtlas/">GitHub
repo</a>. We download
the data in that file and add it to our data frame:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">numberfile</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/jbloomlab/EnvsAntigenicAtlas/&#39;</span>
<span class="gp">... </span>              <span class="s1">&#39;master/results/HXB2_numbering/BG505_to_HXB2.csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">numberfile</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">data_hiv</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">... </span>                <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;original&#39;</span><span class="p">:</span><span class="s1">&#39;isite&#39;</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">:</span><span class="s1">&#39;site&#39;</span><span class="p">})</span>
<span class="gp">... </span>                <span class="p">[[</span><span class="s1">&#39;site&#39;</span><span class="p">,</span> <span class="s1">&#39;isite&#39;</span><span class="p">]]</span>
<span class="gp">... </span>                <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data_hiv</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;site&#39;</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s1">&#39;one_to_many&#39;</span><span class="p">)</span>
<span class="gp">... </span>                <span class="p">)</span>
</pre></div>
</div>
<p>Now see how this data frame also has the <code class="docutils literal notranslate"><span class="pre">isite</span></code> column which has
sequential integer numbering of the sequence:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data_hiv</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">  site  isite wildtype mutation  mutfracsurvive antibody</span>
<span class="go">0   31     30        A        Y        0.030824      PG9</span>
<span class="go">1   31     30        A        K        0.006860      PG9</span>
<span class="go">2   31     30        A        D        0.006774      PG9</span>
<span class="go">3   31     30        A        S        0.004407      PG9</span>
<span class="go">4   31     30        A        R        0.003501      PG9</span>
</pre></div>
</div>
<p>We add a column (<code class="docutils literal notranslate"><span class="pre">site_label</span></code>) that gives the site labeled with the
wildtype identity that we can use for axis ticks. We also indicate which
sites to show (column <code class="docutils literal notranslate"><span class="pre">show_site</span></code>) in our logoplot snippet (these are
just the same ones in Figure 3 of the <a class="reference external" href="https://doi.org/10.1016/j.immuni.2018.12.017">Dingens et al
(2019)</a> paper):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># same sites in Figure 3D,E of Dingens et al (2019)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sites_to_show</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">119</span><span class="p">,</span> <span class="mi">125</span><span class="p">))</span> <span class="o">+</span>
<span class="gp">... </span>                         <span class="p">[</span><span class="mi">127</span><span class="p">]</span> <span class="o">+</span>
<span class="gp">... </span>                         <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">156</span><span class="p">,</span> <span class="mi">174</span><span class="p">))</span> <span class="o">+</span>
<span class="gp">... </span>                         <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">199</span><span class="p">,</span> <span class="mi">205</span><span class="p">))</span> <span class="o">+</span>
<span class="gp">... </span>                         <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">312</span><span class="p">,</span> <span class="mi">316</span><span class="p">))</span>
<span class="gp">... </span>                         <span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_hiv</span> <span class="o">=</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">data_hiv</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">site_label</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;wildtype&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;site&#39;</span><span class="p">],</span>
<span class="gp">... </span>            <span class="n">show_site</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;site&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">sites_to_show</span><span class="p">),</span>
<span class="gp">... </span>            <span class="p">)</span>
<span class="gp">... </span>    <span class="p">)</span>
</pre></div>
</div>
<p>See how the data frame now has the <code class="docutils literal notranslate"><span class="pre">site_label</span></code> and <code class="docutils literal notranslate"><span class="pre">show_site</span></code>
columns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data_hiv</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">  site  isite wildtype mutation  mutfracsurvive antibody site_label  show_site</span>
<span class="go">0   31     30        A        Y        0.030824      PG9        A31      False</span>
<span class="go">1   31     30        A        K        0.006860      PG9        A31      False</span>
<span class="go">2   31     30        A        D        0.006774      PG9        A31      False</span>
<span class="go">3   31     30        A        S        0.004407      PG9        A31      False</span>
<span class="go">4   31     30        A        R        0.003501      PG9        A31      False</span>
</pre></div>
</div>
</div>
<div class="section" id="draw-a-logo-plot">
<h3><a class="toc-backref" href="#id12">Draw a logo plot</a><a class="headerlink" href="#draw-a-logo-plot" title="Permalink to this headline">¶</a></h3>
<p>Now we make logo plots of the sites that we have selected to show, here
just for the <em>PG9</em> antibody. Note how we query <code class="docutils literal notranslate"><span class="pre">data_hiv</span></code> for only the
antibody (<em>PG9</em>) and the sites of interest (<code class="docutils literal notranslate"><span class="pre">show_site</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">dmslogo</span><span class="o">.</span><span class="n">draw_logo</span><span class="p">(</span><span class="n">data_hiv</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;antibody == &quot;PG9&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;show_site&#39;</span><span class="p">),</span>
<span class="gp">... </span>                            <span class="n">x_col</span><span class="o">=</span><span class="s1">&#39;isite&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">letter_col</span><span class="o">=</span><span class="s1">&#39;mutation&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">letter_height_col</span><span class="o">=</span><span class="s1">&#39;mutfracsurvive&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">xtick_col</span><span class="o">=</span><span class="s1">&#39;site_label&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;PG9&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//examples-21.png">png</a>, <a class="reference external" href=".//examples-21.hires.png">hires.png</a>, <a class="reference external" href=".//examples-21.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/examples-21.png" src="_images/examples-21.png" />
</div>
</div>
<div class="section" id="draw-site-level-line-plots">
<h3><a class="toc-backref" href="#id13">Draw site-level line plots</a><a class="headerlink" href="#draw-site-level-line-plots" title="Permalink to this headline">¶</a></h3>
<p>The logo plot above shows selection at a subset of sites. But we might
also want to summarize the selection across all sites (as is done in
Figure 2 of <a class="reference external" href="https://doi.org/10.1016/j.immuni.2018.12.017">Dingens et al
(2019)</a>).</p>
<p>An easy way to do this is to create a summary statistic at each site.
Here we compute the average
<a class="reference external" href="https://jbloomlab.github.io/dms_tools2/dms_tools2.fracsurvive.html">fracsurvive</a>
at each site across all mutations, and add that to our data frame:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data_hiv</span> <span class="o">=</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">data_hiv</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;mutation != wildtype&#39;</span><span class="p">)</span> <span class="c1"># only care about mutations; get rid of wildtype values</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">avgfracsurvive</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;antibody&#39;</span><span class="p">,</span> <span class="s1">&#39;site&#39;</span><span class="p">])</span>
<span class="gp">... </span>                                        <span class="p">[</span><span class="s1">&#39;mutfracsurvive&#39;</span><span class="p">]</span>
<span class="gp">... </span>                                        <span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
<span class="gp">... </span>            <span class="p">)</span>
<span class="gp">... </span>    <span class="p">)</span>
</pre></div>
</div>
<p>Now the data frame has a column (<code class="docutils literal notranslate"><span class="pre">avgfracsurvive</span></code>) giving the average
fraction surviving at each site:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data_hiv</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">  site  isite wildtype mutation  mutfracsurvive antibody site_label  show_site  avgfracsurvive</span>
<span class="go">0   31     30        A        Y        0.030824      PG9        A31      False         0.00329</span>
<span class="go">1   31     30        A        K        0.006860      PG9        A31      False         0.00329</span>
<span class="go">2   31     30        A        D        0.006774      PG9        A31      False         0.00329</span>
<span class="go">3   31     30        A        S        0.004407      PG9        A31      False         0.00329</span>
<span class="go">4   31     30        A        R        0.003501      PG9        A31      False         0.00329</span>
</pre></div>
</div>
<p>Now we use the <a class="reference internal" href="dmslogo.line.html#dmslogo.line.draw_line" title="dmslogo.line.draw_line"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dmslogo.line.draw_line</span></code></a> function to draw the line plot for
antibody <em>PG9</em>. Note how we provide our new <code class="docutils literal notranslate"><span class="pre">avgfracsurvive</span></code> column as
<code class="docutils literal notranslate"><span class="pre">height_col</span></code>. We also provide our previously defined <code class="docutils literal notranslate"><span class="pre">show_site</span></code>
column (which indicates which sites were shown in the logo plot) as the
<code class="docutils literal notranslate"><span class="pre">show_col</span></code>, so that the line plot has the sites shown in the above
logo plot underlined in orange:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">dmslogo</span><span class="o">.</span><span class="n">draw_line</span><span class="p">(</span><span class="n">data_hiv</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;antibody == &quot;PG9&quot;&#39;</span><span class="p">),</span>
<span class="gp">... </span>                            <span class="n">x_col</span><span class="o">=</span><span class="s1">&#39;isite&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">height_col</span><span class="o">=</span><span class="s1">&#39;avgfracsurvive&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">xtick_col</span><span class="o">=</span><span class="s1">&#39;site&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">show_col</span><span class="o">=</span><span class="s1">&#39;show_site&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;PG9&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">widthscale</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//examples-24.png">png</a>, <a class="reference external" href=".//examples-24.hires.png">hires.png</a>, <a class="reference external" href=".//examples-24.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/examples-24.png" src="_images/examples-24.png" />
</div>
</div>
<div class="section" id="combining-site-level-line-and-mutation-level-logo-plots">
<h3><a class="toc-backref" href="#id14">Combining site-level line and mutation-level logo plots</a><a class="headerlink" href="#combining-site-level-line-and-mutation-level-logo-plots" title="Permalink to this headline">¶</a></h3>
<p>Of course, a line plot isn’t that hard to make, but the advantage of
doing this using the approach above is that we can combine
<a class="reference internal" href="dmslogo.line.html#dmslogo.line.draw_line" title="dmslogo.line.draw_line"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dmslogo.line.draw_line</span></code></a> and <a class="reference internal" href="dmslogo.logo.html#dmslogo.logo.draw_logo" title="dmslogo.logo.draw_logo"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dmslogo.logo.draw_logo</span></code></a> to create a single
figure that shows the site-selection in a line plot and the selected
sites as logo plots.</p>
<p>The easiest way to do this using the
<a class="reference internal" href="dmslogo.facet.html#dmslogo.facet.facet_plot" title="dmslogo.facet.facet_plot"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dmslogo.facet.facet_plot</span></code></a> command described below. But first
here we do it using matplotlib subplots. Note how the resulting
plot combines the line and logo plots, with the line plot using the orange
underline to indicate which sites are zoomed in the logo plot:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width_ratios&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">dmslogo</span><span class="o">.</span><span class="n">draw_line</span><span class="p">(</span><span class="n">data_hiv</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;antibody == &quot;PG9&quot;&#39;</span><span class="p">),</span>
<span class="gp">... </span>                      <span class="n">x_col</span><span class="o">=</span><span class="s1">&#39;isite&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">height_col</span><span class="o">=</span><span class="s1">&#39;avgfracsurvive&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">xtick_col</span><span class="o">=</span><span class="s1">&#39;site&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">show_col</span><span class="o">=</span><span class="s1">&#39;show_site&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">dmslogo</span><span class="o">.</span><span class="n">draw_logo</span><span class="p">(</span><span class="n">data_hiv</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;antibody == &quot;PG9&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;show_site&#39;</span><span class="p">),</span>
<span class="gp">... </span>                      <span class="n">x_col</span><span class="o">=</span><span class="s1">&#39;isite&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">letter_col</span><span class="o">=</span><span class="s1">&#39;mutation&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">letter_height_col</span><span class="o">=</span><span class="s1">&#39;mutfracsurvive&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="n">xtick_col</span><span class="o">=</span><span class="s1">&#39;site_label&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//examples-25.png">png</a>, <a class="reference external" href=".//examples-25.hires.png">hires.png</a>, <a class="reference external" href=".//examples-25.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/examples-25.png" src="_images/examples-25.png" />
</div>
</div>
</div>
<div class="section" id="faceting-line-and-logo-plots-together">
<h2><a class="toc-backref" href="#id15">Faceting line and logo plots together</a><a class="headerlink" href="#faceting-line-and-logo-plots-together" title="Permalink to this headline">¶</a></h2>
<p>The easiest way to facet line and logo plots together is using
<a class="reference internal" href="dmslogo.facet.html#dmslogo.facet.facet_plot" title="dmslogo.facet.facet_plot"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dmslogo.facet.facet_plot</span></code></a>.</p>
<p>The cell below shows how this is done. You pass the data to this
function, as well any columns and rows we would like to facet, the
<code class="docutils literal notranslate"><span class="pre">x_col</span></code> and <code class="docutils literal notranslate"><span class="pre">show_col</span></code> arguments shared between the line and logo
plots, and additional keyword arguments for
<a class="reference internal" href="dmslogo.logo.html#dmslogo.logo.draw_logo" title="dmslogo.logo.draw_logo"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dmslogo.logo.draw_logo</span></code></a> and
<a class="reference internal" href="dmslogo.line.html#dmslogo.line.draw_line" title="dmslogo.line.draw_line"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dmslogo.line.draw_line</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">dmslogo</span><span class="o">.</span><span class="n">facet_plot</span><span class="p">(</span>
<span class="gp">... </span>                    <span class="n">data_hiv</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">gridrow_col</span><span class="o">=</span><span class="s1">&#39;antibody&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">x_col</span><span class="o">=</span><span class="s1">&#39;isite&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">show_col</span><span class="o">=</span><span class="s1">&#39;show_site&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">draw_line_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">height_col</span><span class="o">=</span><span class="s1">&#39;avgfracsurvive&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                          <span class="n">xtick_col</span><span class="o">=</span><span class="s1">&#39;site&#39;</span><span class="p">),</span>
<span class="gp">... </span>                    <span class="n">draw_logo_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">letter_col</span><span class="o">=</span><span class="s1">&#39;mutation&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                          <span class="n">letter_height_col</span><span class="o">=</span><span class="s1">&#39;mutfracsurvive&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                          <span class="n">xtick_col</span><span class="o">=</span><span class="s1">&#39;site_label&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                          <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;site&#39;</span><span class="p">),</span>
<span class="gp">... </span>                    <span class="n">line_titlesuffix</span><span class="o">=</span><span class="s1">&#39;site-level selection&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">logo_titlesuffix</span><span class="o">=</span><span class="s1">&#39;mutation-level selection&#39;</span>
<span class="gp">... </span>                    <span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//examples-26.png">png</a>, <a class="reference external" href=".//examples-26.hires.png">hires.png</a>, <a class="reference external" href=".//examples-26.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/examples-26.png" src="_images/examples-26.png" />
</div>
<p>There are various options to tweak the formatting of the faceted plot. Here we demonstrate a few of them:</p>
<blockquote>
<div><ul class="simple">
<li>We assign a more generic ylabel (“immune selection”) to each plot via the appropriate <code class="docutils literal notranslate"><span class="pre">*_kwargs</span></code> option.</li>
<li>We use the <code class="docutils literal notranslate"><span class="pre">share_ylim_across_rows=False</span></code> option to allow each row to have its own y-axis limits.</li>
<li>We use the <code class="docutils literal notranslate"><span class="pre">share_xlabel</span></code> and <code class="docutils literal notranslate"><span class="pre">share_ylabel</span></code> options to share the x- and y-labels across the line and logo plots.</li>
</ul>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">dmslogo</span><span class="o">.</span><span class="n">facet_plot</span><span class="p">(</span>
<span class="gp">... </span>                    <span class="n">data_hiv</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">gridrow_col</span><span class="o">=</span><span class="s1">&#39;antibody&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">x_col</span><span class="o">=</span><span class="s1">&#39;isite&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">show_col</span><span class="o">=</span><span class="s1">&#39;show_site&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">draw_line_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">height_col</span><span class="o">=</span><span class="s1">&#39;avgfracsurvive&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                          <span class="n">xtick_col</span><span class="o">=</span><span class="s1">&#39;site&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                          <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;immune selection&#39;</span><span class="p">),</span>
<span class="gp">... </span>                    <span class="n">draw_logo_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">letter_col</span><span class="o">=</span><span class="s1">&#39;mutation&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                          <span class="n">letter_height_col</span><span class="o">=</span><span class="s1">&#39;mutfracsurvive&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                          <span class="n">xtick_col</span><span class="o">=</span><span class="s1">&#39;site_label&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                          <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;site&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                          <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;immune selection&#39;</span><span class="p">),</span>
<span class="gp">... </span>                    <span class="n">line_titlesuffix</span><span class="o">=</span><span class="s1">&#39;site-level selection&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">logo_titlesuffix</span><span class="o">=</span><span class="s1">&#39;mutation-level selection&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">share_ylim_across_rows</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">share_xlabel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">share_ylabel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//examples-27.png">png</a>, <a class="reference external" href=".//examples-27.hires.png">hires.png</a>, <a class="reference external" href=".//examples-27.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/examples-27.png" src="_images/examples-27.png" />
</div>
</div>
<div class="section" id="write-dmslogo-in-comic-sans-font">
<h2><a class="toc-backref" href="#id16">Write <em>DMSLOGO</em> in Comic Sans font</a><a class="headerlink" href="#write-dmslogo-in-comic-sans-font" title="Permalink to this headline">¶</a></h2>
<p>Generate data to plot by creating the pandas DataFrame <code class="docutils literal notranslate"><span class="pre">word_data</span></code>. In
this data frame, we choose large heights and bright colors for the
letters in our word (<em>DMSLOGO</em>), and smaller letters and gray for other
letters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">word</span> <span class="o">=</span> <span class="s1">&#39;DMSLOGO&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lettercolors</span> <span class="o">=</span> <span class="p">[</span><span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="s1">&#39;dms&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="s1">&#39;logo&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># make data frame with data to plot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">word_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:[],</span> <span class="s1">&#39;letter&#39;</span><span class="p">:[],</span> <span class="s1">&#39;height&#39;</span><span class="p">:[],</span> <span class="s1">&#39;color&#39;</span><span class="p">:[]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">lettercolors</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">word_data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">word_data</span><span class="p">[</span><span class="s1">&#39;letter&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">letter</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">word_data</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">word_data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">))</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">otherletter</span> <span class="ow">in</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="s1">&#39;ACTG&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="p">{</span><span class="n">letter</span><span class="p">}),</span> <span class="mi">3</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">word_data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">word_data</span><span class="p">[</span><span class="s1">&#39;letter&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">otherletter</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">word_data</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CBPALETTE</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">... </span>        <span class="n">word_data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">word_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">word_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">word_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="go">   x letter    height    color</span>
<span class="go">0  0      D  1.422211  #E69F00</span>
<span class="go">1  0      T  0.486186  #999999</span>
<span class="go">2  0      A  0.294371  #999999</span>
<span class="go">3  0      C  0.467294  #999999</span>
<span class="go">4  1      M  1.414926  #E69F00</span>
<span class="go">5  1      T  0.301875  #999999</span>
</pre></div>
</div>
<p>Now draw the logo. We use the <code class="docutils literal notranslate"><span class="pre">fontfamily</span></code> argument to set a Comic
Sans font This also requires us to increase <code class="docutils literal notranslate"><span class="pre">fontaspect</span></code> since this
font is wider, and increase <code class="docutils literal notranslate"><span class="pre">letterpad</span></code> as the font height sometimes
sticks out beyond its baseline:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">dmslogo</span><span class="o">.</span><span class="n">draw_logo</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">word_data</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">letter_height_col</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">x_col</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">letter_col</span><span class="o">=</span><span class="s1">&#39;letter&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">color_col</span><span class="o">=</span><span class="s1">&#39;color&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">fontfamily</span><span class="o">=</span><span class="s1">&#39;Comic Sans MS&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">hide_axis</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">fontaspect</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">letterpad</span><span class="o">=</span><span class="mf">0.05</span>
<span class="gp">... </span>                            <span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//examples-29.png">png</a>, <a class="reference external" href=".//examples-29.hires.png">hires.png</a>, <a class="reference external" href=".//examples-29.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/examples-29.png" src="_images/examples-29.png" />
</div>
<div class="section" id="subtleties-of-non-default-fonts">
<h3><a class="toc-backref" href="#id17">Subtleties of non-default fonts</a><a class="headerlink" href="#subtleties-of-non-default-fonts" title="Permalink to this headline">¶</a></h3>
<p>Note however that you in general may have difficulty using most fonts
(other than the <code class="docutils literal notranslate"><span class="pre">dmslogo</span></code> default) for good-looking logos.
The reason is that for a clean and accurate letter-height logo plots, the font must:</p>
<blockquote>
<div><ul class="simple">
<li>be mono-spaced</li>
<li>not have descenders</li>
<li>have all letters go exactly from the baseline to the top</li>
</ul>
</div></blockquote>
<p>You can manually edit a font to do this as has been done for the
current <code class="docutils literal notranslate"><span class="pre">dmslogo</span></code> default font; to see more information on this
look <a class="reference external" href="https://github.com/jbloomlab/dmslogo/tree/master/dmslogo/ttf_fonts">here for details</a>.</p>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/BloomLogo.jpg" alt="Logo"/>
    
    <h1 class="logo logo-name">dmslogo</h1>
    
  </a>
</p>



<p class="blurb">Sequence logos for deep mutational scanning</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=jbloomlab&repo=dmslogo&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a class="badge" href="https://travis-ci.org/jbloomlab/dmslogo">
    <img
        alt="https://secure.travis-ci.org/jbloomlab/dmslogo.svg?branch=master"
        src="https://secure.travis-ci.org/jbloomlab/dmslogo.svg?branch=master"
    />
</a>
</p>


<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="dmslogo.html">dmslogo package</a></li>
<li class="toctree-l1"><a class="reference internal" href="package_index.html">package index</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgments.html">Acknowledgements</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="installation.html" title="previous chapter">Installation</a></li>
      <li>Next: <a href="dmslogo.html" title="next chapter">dmslogo package</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019--2019, Bloom lab.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/examples.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/jbloomlab/dmslogo" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>